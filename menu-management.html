<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HawkerHub - Menu Management</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
    />
  </head>
  <body class="bg-light">
    <nav class="navbar bg-white shadow-sm py-3">
      <div class="container">
        <a class="navbar-brand text-danger fw-bold" href="index.html">
          <i class="bi bi-shop-window me-2"></i>HawkerHub
        </a>
        <a href="vendor-dashboard.html" class="btn btn-outline-danger btn-sm">
          <i class="bi bi-arrow-left me-1"></i>Dashboard
        </a>
      </div>
    </nav>

    <main class="container py-4">
      <h1 class="text-danger mb-4">Menu Management</h1>

      <!-- Add New Item -->
      <div class="card mb-4">
        <div class="card-header bg-danger text-white">
          <h5 class="mb-0">Add Menu Item</h5>
        </div>
        <div class="card-body">
          <form id="addItemForm">
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <input
                  type="text"
                  class="form-control"
                  placeholder="Item Name *"
                  id="itemName"
                  required
                />
              </div>
              <div class="col-md-6">
                <select class="form-select" id="itemCategory" required>
                  <option value="">Category</option>
                  <option>Main Course</option>
                  <option>Side Dish</option>
                  <option>Beverage</option>
                  <option>Dessert</option>
                </select>
              </div>
            </div>
            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <input
                  type="number"
                  class="form-control"
                  placeholder="Price ($) *"
                  id="itemPrice"
                  step="0.50"
                  required
                />
              </div>
              <div class="col-md-6">
                <select class="form-select" id="itemAvailability" required>
                  <option value="available">Available</option>
                  <option value="unavailable">Unavailable</option>
                  <option value="soldout">Sold Out</option>
                </select>
              </div>
            </div>
            <div class="mb-3">
              <textarea
                class="form-control"
                placeholder="Description"
                id="itemDescription"
                rows="2"
              ></textarea>
            </div>
            <button type="submit" class="btn btn-danger w-100">Add Item</button>
          </form>
        </div>
      </div>

      <!-- Menu Items -->
      <div class="card">
        <div class="card-header bg-danger text-white">
          <h5 class="mb-0">Menu Items</h5>
        </div>
        <div class="card-body p-0">
          <div class="table-responsive">
            <table class="table table-hover mb-0">
              <thead class="table-light">
                <tr>
                  <th>Item Name</th>
                  <th>Category</th>
                  <th>Price</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="menuItemsTable">
                <tr>
                  <td>Chicken Rice</td>
                  <td>Main Course</td>
                  <td>$5.50</td>
                  <td><span class="badge bg-success">Available</span></td>
                  <td>
                    <button
                      class="btn btn-sm btn-outline-danger me-1"
                      onclick="editItem(this)"
                    >
                      Edit
                    </button>
                    <button
                      class="btn btn-sm btn-danger"
                      onclick="deleteItem(this)"
                    >
                      Delete
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>Roasted Chicken Rice</td>
                  <td>Main Course</td>
                  <td>$6.00</td>
                  <td><span class="badge bg-success">Available</span></td>
                  <td>
                    <button
                      class="btn btn-sm btn-outline-danger me-1"
                      onclick="editItem(this)"
                    >
                      Edit
                    </button>
                    <button
                      class="btn btn-sm btn-danger"
                      onclick="deleteItem(this)"
                    >
                      Delete
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>Iced Teh Tarik</td>
                  <td>Beverage</td>
                  <td>$2.50</td>
                  <td><span class="badge bg-warning">Sold Out</span></td>
                  <td>
                    <button
                      class="btn btn-sm btn-outline-danger me-1"
                      onclick="editItem(this)"
                    >
                      Edit
                    </button>
                    <button
                      class="btn btn-sm btn-danger"
                      onclick="deleteItem(this)"
                    >
                      Delete
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </main>

    <footer class="bg-dark text-white py-3 mt-4">
      <div class="container text-center">
        <p class="mb-0 small">&copy; 2024 HawkerHub</p>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      // Check vendor
      const user = JSON.parse(localStorage.getItem("hawkerhub_user"));
      if (!user || user.role !== "vendor") {
        window.location.href = "login.html";
      }

      // Add item
      document
        .getElementById("addItemForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const itemName = document.getElementById("itemName").value;
          const category = document.getElementById("itemCategory").value;
          const price = parseFloat(document.getElementById("itemPrice").value);
          const availability =
            document.getElementById("itemAvailability").value;

          let badgeClass = "bg-secondary";
          if (availability === "available") badgeClass = "bg-success";
          else if (availability === "unavailable") badgeClass = "bg-danger";
          else if (availability === "soldout") badgeClass = "bg-warning";

          const table = document.getElementById("menuItemsTable");
          const row = table.insertRow();
          row.innerHTML = `
                <td>${itemName}</td>
                <td>${category}</td>
                <td>$${price.toFixed(2)}</td>
                <td><span class="badge ${badgeClass}">${availability}</span></td>
                <td>
                    <button class="btn btn-sm btn-outline-danger me-1" onclick="editItem(this)">Edit</button>
                    <button class="btn btn-sm btn-danger" onclick="deleteItem(this)">Delete</button>
                </td>
            `;

          document.getElementById("addItemForm").reset();
          alert("Item added!");
        });

      function editItem(button) {
        const row = button.closest("tr");
        const cells = row.querySelectorAll("td");

        document.getElementById("itemName").value = cells[0].textContent;
        document.getElementById("itemCategory").value = cells[1].textContent;
        document.getElementById("itemPrice").value =
          cells[2].textContent.replace("$", "");
        document.getElementById("itemAvailability").value = cells[3]
          .querySelector(".badge")
          .textContent.toLowerCase();

        const form = document.getElementById("addItemForm");
        const btn = form.querySelector('button[type="submit"]');
        btn.textContent = "Update Item";

        form.onsubmit = function (e) {
          e.preventDefault();

          cells[0].textContent = document.getElementById("itemName").value;
          cells[1].textContent = document.getElementById("itemCategory").value;
          cells[2].textContent =
            "$" + document.getElementById("itemPrice").value;

          const avail = document.getElementById("itemAvailability").value;
          let badgeClass = "bg-secondary";
          if (avail === "available") badgeClass = "bg-success";
          else if (avail === "unavailable") badgeClass = "bg-danger";
          else if (avail === "soldout") badgeClass = "bg-warning";

          cells[3].innerHTML = `<span class="badge ${badgeClass}">${avail}</span>`;

          form.reset();
          btn.textContent = "Add Item";
          form.onsubmit = null;
          alert("Item updated!");
        };
      }

      function deleteItem(button) {
        if (confirm("Delete this item?")) {
          button.closest("tr").remove();
          alert("Item deleted!");
        }
      }
    </script>
  </body>
</html>
