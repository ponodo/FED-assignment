<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HawkerHub - Menu Management</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
    />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
      <div class="container">
        <a class="navbar-brand text-danger fw-bold" href="index.html">
          <i class="bi bi-shop-window me-2"></i>HawkerHub
        </a>
        <div class="d-flex align-items-center">
          <a href="vendor-dashboard.html" class="btn btn-outline-danger me-3">
            <i class="bi bi-arrow-left me-2"></i>Back to Dashboard
          </a>
        </div>
      </div>
    </nav>

    <div class="container mt-5">
      <h1 class="mb-4 text-danger">Menu Management</h1>

      <!-- Add New Item -->
      <div class="card mb-4">
        <div class="card-header bg-danger text-white">
          <h5 class="mb-0">Add New Menu Item</h5>
        </div>
        <div class="card-body">
          <form id="addItemForm">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label">Item Name *</label>
                <input
                  type="text"
                  class="form-control"
                  id="itemName"
                  required
                />
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Category *</label>
                <select class="form-control" id="itemCategory" required>
                  <option value="">Select Category</option>
                  <option>Main Course</option>
                  <option>Side Dish</option>
                  <option>Beverage</option>
                  <option>Dessert</option>
                  <option>Set Meal</option>
                </select>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label">Price ($) *</label>
                <input
                  type="number"
                  class="form-control"
                  id="itemPrice"
                  step="0.50"
                  min="0"
                  required
                />
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Availability *</label>
                <select class="form-control" id="itemAvailability" required>
                  <option value="available">Available</option>
                  <option value="unavailable">Unavailable</option>
                  <option value="soldout">Sold Out</option>
                </select>
              </div>
            </div>
            <div class="mb-3">
              <label class="form-label">Description</label>
              <textarea
                class="form-control"
                id="itemDescription"
                rows="2"
                placeholder="Describe your dish..."
              ></textarea>
            </div>
            <div class="d-grid">
              <button type="submit" class="btn btn-danger">
                Add Item to Menu
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Menu Items List -->
      <div class="card">
        <div class="card-header bg-danger text-white">
          <h5 class="mb-0">Menu Items</h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Item Name</th>
                  <th>Category</th>
                  <th>Price</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="menuItemsTable">
                <tr>
                  <td>Chicken Rice</td>
                  <td>Main Course</td>
                  <td>$5.50</td>
                  <td><span class="badge bg-success">Available</span></td>
                  <td>
                    <button class="btn btn-sm btn-outline-danger me-1">
                      Edit
                    </button>
                    <button class="btn btn-sm btn-danger">Delete</button>
                  </td>
                </tr>
                <tr>
                  <td>Roasted Chicken Rice</td>
                  <td>Main Course</td>
                  <td>$6.00</td>
                  <td><span class="badge bg-success">Available</span></td>
                  <td>
                    <button class="btn btn-sm btn-outline-danger me-1">
                      Edit
                    </button>
                    <button class="btn btn-sm btn-danger">Delete</button>
                  </td>
                </tr>
                <tr>
                  <td>Iced Teh Tarik</td>
                  <td>Beverage</td>
                  <td>$2.50</td>
                  <td><span class="badge bg-warning">Sold Out</span></td>
                  <td>
                    <button class="btn btn-sm btn-outline-danger me-1">
                      Edit
                    </button>
                    <button class="btn btn-sm btn-danger">Delete</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <footer class="bg-dark text-white py-4 mt-5">
      <div class="container text-center">
        <p>&copy; 2024 HawkerHub. All rights reserved.</p>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      // Check if user is vendor
      window.onload = function () {
        const user = JSON.parse(localStorage.getItem("hawkerhub_user"));
        if (!user || user.role !== "vendor") {
          window.location.href = "login.html";
        }
      };

      // Handle adding new item
      document
        .getElementById("addItemForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const itemName = document.getElementById("itemName").value;
          const category = document.getElementById("itemCategory").value;
          const price = parseFloat(document.getElementById("itemPrice").value);
          const availability =
            document.getElementById("itemAvailability").value;
          const description = document.getElementById("itemDescription").value;

          // Add to table
          const tableBody = document.getElementById("menuItemsTable");
          const newRow = document.createElement("tr");

          // Get status badge class
          let badgeClass = "bg-secondary";
          if (availability === "available") badgeClass = "bg-success";
          else if (availability === "unavailable") badgeClass = "bg-danger";
          else if (availability === "soldout") badgeClass = "bg-warning";

          newRow.innerHTML = `
                <td>${itemName}</td>
                <td>${category}</td>
                <td>$${price.toFixed(2)}</td>
                <td><span class="badge ${badgeClass}">${availability}</span></td>
                <td>
                    <button class="btn btn-sm btn-outline-danger me-1" onclick="editItem(this)">Edit</button>
                    <button class="btn btn-sm btn-danger" onclick="deleteItem(this)">Delete</button>
                </td>
            `;

          tableBody.appendChild(newRow);

          // Clear form
          document.getElementById("addItemForm").reset();

          alert("Menu item added successfully!");
        });

      // Edit item
      function editItem(button) {
        const row = button.closest("tr");
        const cells = row.querySelectorAll("td");

        // Get current values
        const itemName = cells[0].textContent;
        const category = cells[1].textContent;
        const price = cells[2].textContent.replace("$", "");
        const availability = cells[3].querySelector(".badge").textContent;

        // Fill form with current values
        document.getElementById("itemName").value = itemName;
        document.getElementById("itemCategory").value = category;
        document.getElementById("itemPrice").value = price;
        document.getElementById("itemAvailability").value =
          availability.toLowerCase();

        // Change form button to "Update"
        const form = document.getElementById("addItemForm");
        const submitBtn = form.querySelector('button[type="submit"]');
        submitBtn.textContent = "Update Item";
        submitBtn.onclick = function (e) {
          e.preventDefault();

          // Update row
          cells[0].textContent = document.getElementById("itemName").value;
          cells[1].textContent = document.getElementById("itemCategory").value;
          cells[2].textContent =
            "$" + document.getElementById("itemPrice").value;

          const newAvailability =
            document.getElementById("itemAvailability").value;
          let badgeClass = "bg-secondary";
          if (newAvailability === "available") badgeClass = "bg-success";
          else if (newAvailability === "unavailable") badgeClass = "bg-danger";
          else if (newAvailability === "soldout") badgeClass = "bg-warning";

          cells[3].innerHTML = `<span class="badge ${badgeClass}">${newAvailability}</span>`;

          // Reset form
          form.reset();
          submitBtn.textContent = "Add Item to Menu";
          submitBtn.onclick = null;

          alert("Item updated successfully!");
        };
      }

      // Delete item
      function deleteItem(button) {
        if (confirm("Are you sure you want to delete this menu item?")) {
          const row = button.closest("tr");
          row.remove();
          alert("Menu item deleted!");
        }
      }
    </script>
  </body>
</html>
